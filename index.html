<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Roblox ID Lookuper</title>
  <style>
    body { font-family: sans-serif; background:#0f1724; color:#fff; margin:0; padding:20px; }
    .card { background:#1b2333; padding:20px; border-radius:12px; max-width:800px; margin:auto; }
    input { width:70%; padding:10px; border-radius:6px; border:none; margin-right:8px; }
    button { padding:10px 16px; border:none; border-radius:6px; background:#7c3aed; color:#fff; cursor:pointer; }
    .result { margin-top:20px; }
    img { border-radius:8px; max-width:200px; margin-top:10px; }
    .error { color: #ff6b6b; margin-top:10px; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Roblox ID Lookuper</h1>
    <p>Enter a Roblox username, user ID, or asset ID / URL.</p>
    <input id="input" type="text" placeholder="e.g. builderman or https://www.roblox.com/users/156/profile">
    <button id="lookupBtn">Lookup</button>
    <div id="output" class="result"></div>
  </div>

  <script>
    const proxy = "https://your-vercel-app.vercel.app/api?url="; // ðŸ‘ˆ replace with your proxy URL

    document.getElementById("lookupBtn").addEventListener("click", async () => {
      const val = document.getElementById("input").value.trim();
      const output = document.getElementById("output");
      output.innerHTML = "";

      if (!val) return output.innerHTML = "<p class='error'>Please enter something.</p>";

      // detect numeric ID
      if (/^[0-9]+$/.test(val)) {
        return fetchUser(val);
      }

      // detect user URL
      if (val.includes("roblox.com/users/")) {
        const id = val.match(/users\\/(\\d+)/)?.[1];
        if (id) return fetchUser(id);
      }

      // detect asset URL
      if (val.includes("roblox.com/catalog/") || val.includes("roblox.com/library/")) {
        const id = val.match(/(?:catalog|library)\\/(\\d+)/)?.[1];
        if (id) return fetchAsset(id);
      }

      // otherwise assume username
      fetchUserByName(val);
    });

    async function fetchUserByName(username) {
      const res = await fetch(proxy + "https://users.roblox.com/v1/usernames/users", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ usernames: [username], excludeBannedUsers: false })
      });
      if (!res.ok) return showError("Failed to fetch username.");
      const data = await res.json();
      if (data.data?.length) {
        fetchUser(data.data[0].id);
      } else showError("User not found.");
    }

    async function fetchUser(id) {
      const res = await fetch(proxy + "https://users.roblox.com/v1/users/" + id);
      if (!res.ok) return showError("User not found.");
      const user = await res.json();

      const thumb = await fetch(proxy + `https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${id}&size=420x420&format=Png&isCircular=false`);
      const t = await thumb.json();
      const img = t.data?.[0]?.imageUrl || "";

      document.getElementById("output").innerHTML = `
        <h2>${user.name} (#${user.id})</h2>
        <p>Display: ${user.displayName}</p>
        <p>Created: ${new Date(user.created).toLocaleDateString()}</p>
        ${img ? `<img src="${img}">` : ""}
        <p><a href="https://roblox.com/users/${user.id}/profile" target="_blank">View on Roblox</a></p>
      `;
    }

    async function fetchAsset(id) {
      const res = await fetch(proxy + "https://economy.roblox.com/v2/assets/" + id + "/details");
      if (!res.ok) return showError("Asset not found.");
      const asset = await res.json();

      const thumb = await fetch(proxy + `https://thumbnails.roblox.com/v1/assets?assetIds=${id}&size=420x420&format=Png`);
      const t = await thumb.json();
      const img = t.data?.[0]?.imageUrl || "";

      document.getElementById("output").innerHTML = `
        <h2>${asset.name}</h2>
        <p>ID: ${asset.id}</p>
        <p>Creator: ${asset.creator?.name}</p>
        <p>Type: ${asset.assetType?.name}</p>
        ${img ? `<img src="${img}"><br><a href="${img}" download>Download Image</a>` : ""}
        <p><a href="https://roblox.com/library/${asset.id}" target="_blank">View on Roblox</a></p>
      `;
    }

    function showError(msg) {
      document.getElementById("output").innerHTML = `<p class="error">${msg}</p>`;
    }
  </script>
</body>
</html>
